// Copyright (c) 2012, the Dart project authors.  Please see the AUTHORS file
// for details. All rights reserved. Use of this source code is governed by a
// BSD-style license that can be found in the LICENSE file.

// Library tag to allow Dartium to run the tests.
library sha384_test;

import "package:expect/expect.dart";
import 'dart:crypto';
import 'dart:io';

part 'sha384_long_test_vectors.dart';
part 'sha384_short_test_vectors.dart';

List<int> createTestArr(int len) {
  var arr = new List<int>(len);
  for (var i = 0; i < len; i++) {
    arr[i] = i;
  }
  return arr;
}

void test() {
  final expected_values = const [
      '38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da274edebfe76f65fbd51ad2f14898b95b',
      'bec021b4f368e3069134e012c2b4307083d3a9bdd206e24e5f0d86e13d6636655933ec2b413465966817a9c208a11717',
      '5d13bb39a64c4ee16e0e8d2e1c13ec4731ff1ac69652c072d0cdc355eb9e0ec41b08aef3dd6fe0541e9fa9e3dcc80f7b',
      '4f895854c1a4fc5aa2e0456eaf8d0ecaa70c196bd901153861d76b8fa3cd95ceea29eab6a279f8b08437703ce0b4b91a',
      '80ae432e757826025095ca1fa4f89c06c8ba6754b1d883a8e31a1e65fcfb820bd74acfaca3d939a574ea408a74162d1d',
      '561c16404a1b592406301780c0c2df6aa0555f504f35bfbeac810ae36a343b776858c5e0de56bb79607a34d2f67108f2',
      '79f4738706fce9650ac60266675c3cd07298b09923850d525604d040e6e448adc7dc22780d7e1b95bfeaa86a678e4552',
      'e6ce1896c9783a70ac4c90276cc37b37687d7e30c753975762f961ae37118d9a610242716e8359efc4975aa98c632dcf',
      'cfb18f81f4bb672b03214f1fede456f882a0de40120212a1feba8fdc48f763c86acbbfb684d34b70f99f4d8d81fe3a28',
      'd075ae1178210804635ac02c656309311527fc8190835c8ad8196577c3332af4d87f056023f235db893c69aa87b0cfb9',
      '182e95266adff49059e706c61483478fe0688150c8d08b95fab5cfde961f12d903aaf44104af4ce72ba6a4bf20302b2e',
      '89bfcf569ae4af718510da78c67414109f5739bb5c40d51c9c8c50e2b2cee86f2f80c8b9d68f7c01201a0714572fe602',
      'b635441a3721cf190b39d23703c5b77018ff1a56c94f8252ee95c217e3477f093e8ec65c6ae767179a7872c8db9b2141',
      '48debf56626cc86dfa47ad6fdec73fd182434621da8bc6db23aff067bc36dc8244d3071b1f57de4b716f63d9820dfb23',
      '58475b7cf93feccb2c02b588f1552a359e7ee9ac45d9ae50b2d7c22021466677d70ef24efa5c492515164458e9a24744',
      '0aa75534f0f58756a01e3366f78e7611bc7f432364c649c3f50547f7bca3e5489531b8ab129495feac834ff0a0b45db6',
      'c81df98d9e6de9b858a1e6eba0f1a3a399d98c441e67e1062601806485bb89125efd54cc78df5fbceabc93cd7c7ba13b',
      'fdd3c4c0f87eec0cadd73028a06b01e67696c7e04960936b30c73f004cf6b595d644533f8b473c8e63b02d593a64b041',
      '445e4cca1a03480d149f38014c14d28df8288f2c6cff047f45d4f2580ae85effb3be009c9d2acc54b51467f83a09fbe2',
      '8305dc56172245b82aedce7f9c7dc88c0e62cbf835a2aa133eb579f415ffd15babbc30bb98e55dfda0f9e80275c92bc4',
      '8a48240e1c85e80651eddc88599273444839a952caca2bef4400576e65b1eb6c19c47a3067b63af7cdc4238adb9a8dad',
      '8f2f7669c27a7cb1cf7a84a2c4f050d7141852d8b429291956b85e2db5287741a3104e7e99ca5d23a5eea59a68a4ddb1',
      '32cf04ae2a4a326fde2fbb887f47fb7a2c486e56088d85b45f0c7587591f44797fe0a67e36f571809695e05f254884b2',
      '713a04a3a6ba8d2fd821f1cdf9facaf42795e4247c9a26f0adc5e0e6aacbaffd8f4e02563733c6bdf1a863a787949b35',
      '35d8a5aa0dc9ab4c9a4c62b36e0e1013977c198b05cf6b92cea25c08309dafd282aa9a4862958593c06ba46919ea8019',
      'd3fb60c2e981a5c82f1b1bcb3d4d7af62c9a32a9f0d87e0532c9d3aac083d70133eff63a1e2ccb87360bf032c25fe9e1',
      'b119f9ac74e58bd081e24c0cc1e090012c192996eed67a8eca33794fe7e1920e26c0efaeb866eb5ab82fca3188a3b05a',
      '5b29543ab0f76f246b7fde6e8e5d3df6017a39342bb08351a4ef609ae00a91acb7c5d0487b3760b34cef326f63c84572',
      'f8e1faa657bf829c9d2e4811805238cccd11f0c1ab7619058241ba5606e7bd5e4816163e6e8e82e62a43cb4943a41006',
      '0855b919786b5e5c87b85a6c17a46c550b2ba81b3724389088e2b54ba89d82b8f9841ff442da5db8d54c9b2ac108dc3c',
      '7def8cab7c80cef90fb38989abef6f1a5ec18379681e484a1b4db6624818d2e486fb9c245c1f0ddd85a846d4268344b1',
      '04aaa180c2cd24f0fb150b1aa360f445344150dca13e1abb8117d42e25df7fe29246d9f00c7473d20cec32a71e64e1f5',
      'e7112491faeefd57786da73f367b25a6f5769f5c98fa7b704d8d37747724a647371989e8b0fe8d3cb23f9eedd528456b',
      'ea27126d0b96e00e428943ea94f4b03fd22d56c4ff4636eed139d027e6d45ef57ab86093a7342b3b3851fd3bfd1dda23',
      'b2bd337a4bdd48d25a5e3fce3e0948ec67829b835a8e3dd0d9f4881d10c766369b079028c6060b7263603288d8fa4bba',
      'a9e940504ae6b137bb1bc88ce3a9ae53dcb63afdfe5fa0c652003a921f582c08662425c7fbd5b1e1422e39e645d4a757',
      'f033150d7464d49a076c7d4bb9e2a5488132786cb4851a4c81da5b0fce66d775d3c1766094ad6ca9482dd9539f28ed9a',
      'e64d999e7258abbb4cff6f74af7d6a1e9b044c17e1ace0fc61b29e7732763755a9c1d3a380b080ad968d2228db731de7',
      '9030d47b57abea93b51162556ff352da61fdf501132a9fd94e6cb56690e7a805cdb290fb4ade36bf90a53f20922c9b6e',
      '4473396bb0461edb4712880810a3f7252725ad4fd6092021a40559f453a1c63acffa8a02c85cc8db86560323da0a0fd9',
      '095fdd130278b3c8f574d17283611e4d6199ea63a0f1599e01ed070cd0b115296fe353477582bf279d622355c89a23e4',
      '7ee600cee8437531c6a5bec313d53371f9b56425d5662c104624d83d51111e5c9f4b83000b8a3ef150e04aedcf67c237',
      '676d2bd2500bc527dcb51968fe8742e40d2965047478e69155aab9201e0c9b0f6ba9be85c4734b0dd556b5fa7608be83',
      '09f5fe433d1fb8f62a76e5654b54cb6a9ef505d2465a49dcb9669eac9a30b2532505e4500f842ec9fbe79a382c8c2f4d',
      '075821ca8c547e66ad94f4c4adf866a2a7554e08d2b0f0b3576801773edc85df76107e6912904e9757eba753a77cd0ff',
      '2172c22e7e48bd0b4a73ff02803d6fce776cecbd95dfc43ca0763a0b375d57030000b12e59f9cde81de58e17489b2c41',
      'b9a15689ba4f41be46855775b46a5db9d6826e0cbdbc3b292da6d57b2a179a3d393a8e1b55de79438e5221580c604ead',
      'ebfa57c946831e2e370a6b1be46e27c95c512297499b8bd15722622178e00599deeadd48f1b4b08eb649a137805cb786',
      '25866c8288f9fa319fa9aa2470b4fc2595dffa9154e607444ea3247e81d74a2ae0957d6b7e050f8c96aa7577bedcabb5',
      '3d28682b90022c873cec78c3a47fd45b5124e49ed07e2f0fb41a112a63aacc9e7614adbb007d129c0673b08c51210839',
      'f76d9b7ed868085905ae806cfc5c6de994999e379922ac003d53f00b65467aacef3929392f1f2f56c621d2f552544a22',
      '324951fa2432b63d1765c21f98325bc4ae2ffb25f411047c53ed5a3d550b50e2b8f6e79bbe65f2c686a5132e5b982ac7',
      '320cb033ad533af8edb3e664e34bb85b2327afcfc583ce9202c0b11f16425a58fd895d7435e8953f9506a25de7be6ef3',
      '6065d55530ed8339b09d7a4d9cb1919004f69ed9d6b119e78e1c39c7ad2aac029a3f266f7e48350966b845c4d7d92a72',
      'eb6e866bdc0b5089301d89b870b75056aba6d5fa6c7406a8d6d97ce5175102479647d3f93325a2cb648a3f40cce38542',
      'dcedb6b590edb4efa849c801e6b6490657a5c1e64f69269f5f63c9267f6223de24cea7aaa6b267d9bcecc15147b6c875',
      '7b9132d597b8873ad55bbc30f18ed3f2c9f340e7de69fb5774056c71a06d9bc2b14137e9e1c68b6b645fed28b188249d',
      '0901b1e5b13fce000486bda64fbe45c79fce15f38a4ddd9335a521d98829d267abccd84284bef1ea3c2d4e4687c6d3b8',
      '4a9375dbaa878e2c1c7bfb977989e6d39cc00f890adc425f7084ae3761baefcb9384c8b9eb3add4c3c838a6d560df788',
      '908682c3e0d97a4943063ea9dd0a0f55efca203aca3004010d3d7ef94593592729b523eaae4160c3ea2241eba236fd65',
      '24586f75a43a08d6cf116b87b86cc43300fc4132523cc4824b7fbb3f54a5b41c7d598b40639b25a99732d575a5cfd355',
      '7b4cfb73e247e941570e70c7308acc5166f123187f003b1caa9bcd17dda8ed5535acae443c9ade93c5567090eace29aa',
      'e97ef4578822ddc79af60514a188f8c719e4133b58e5eb134261aa7e89c402ea7219129a06b395e5e1d2738ac23fc876',
      'dd66b519f51a925814407a449c60b34c553d7652d41783ee903a810a4c9f833b8181c91c7f12283eacd6a5f8a2639ddf',
      '9f2c9eb7116b3d7a4ba84a74a4d4eff8a5efcf54b6d7b662693c38577914c73a214766f0a175339bb0895a863824fc0a',
      '14b0a9ffce149426bf5045ffc24c057451d2473186deb4f150117b855911a7641651fb1e15df406eb373d71151c46f25',
      '286505ff7a9ef81224988a8ff1e423a2ad21f6b339e91b89f7f1540f14cc9a603952564539167465ca70ff0b523becf9',
      '8cab08a79ba16f3d7cbeb942c7d8676f8d0295b5faa01f3c850dc4b5fe913af00f2e938be0b442187b135bef1a36c34c',
      '4d12ffbce2e770eca1104bd2f29c65fe95534e390a138c30cb0ecb6436a971116d82c6321d2ea2c0a735af34e5e3e3b2',
      'f8617a35fe9116a719441f82f21c79b8868e5fffc2ea737fdc821246db7610e9868d870575f19b29f2fd259d9242a497',
      '932fc435b590b1e1d49c34eb3b627dad5476216518250b1fbfe772476437872b8da6caf6d2f33ce7af8648d956cf717f',
      '3f63df48c2d87ceb2168befbf6b857a415d8bfb7062251e8e1ab0487483eebde5e8e8b8b0e3ad81ed4ab15e81fd5e448',
      '4a71e4e737de74f78e72ecb9ddb580ea5ac96e5bbd5e52e11d4a41ab3b8303e3af3458a8ad89b39cd9f4a6d5db3c9e2a',
      'cac3a81a98103bbf08c440f6c8f61ac010df8ac05fda77e2ed8660ab73a978b9428ba0458a5c64dfce35d87f0daa2a6f',
      '6e5d162c60a451b6257781fa0e36b3bdd9bc42a7bcfeaeb75c18e541a4de00967e6bf575cb32374c1e9fe7b36d92048b',
      '04ddfd71893d0f4ad2a0b672a057ed2795d6811aeafdb7136bc8c20a55dabb3ae4b62b8a2c722c1f53e18ffa5771610f',
      '555d5b51c2ea17659516a67d31ce2cb302979f80bd7056908c1a152403fd902eaebabdd066ab3f7834e7213a6ce99eeb',
      '44797ce4fec66b26b52a4249c2b267af891c912e55221edb6cafc4e2f022a40e8231931df0b19321d5ccb2ab8a4f256a',
      '51d7ac85289fe7e4d9431414b2bf3760be65fedd1a0b34bed0e1562a73495ee10971b5141835db454c865039154bea15',
      '2e31dae50a484b7e11e2e621d0552803791e07279752e09edf4c884ef24c79c33d9572ae0de6e0b6a20271f1f7ab98ff',
      'ddc65ed22cae4d159d35e129a1602d8fa50d7aa53e209b0d5442bb121db0d5d102441054b2b321675f3722669fecd06e',
      '200e0bc495311e2fe524a1579490d843011a592e4e9b927deb0727e5481898c557cb2941f18af0f2725a1b19de045ba5',
      '561e1875b31deaec4db2ff5bfa7856a6f0abe1294cdcca1da12ccb1786d9556881a768abae50f7243921acf993aaf18c',
      'f6b88007732d5b9f75209f9fe107b9917010d5960184fd239854ab4611cc788d1455b113a5565a87326b3ce6ca190db8',
      'b4e703169169b07ac61e76a75ed4aacee4115f6a43842bf136b514824a05f5c5adb68f2e525d8c9e8bdb20d3bca21155',
      'f72e2083b296eb7468c97749d3aa1b08f418ebcd9a2e5cb4117c5a034bbea5e2004ee1e43e26a98e4f25ad4306af3a57',
      'b1de9ed0d5e5f7fdcdf530041d7320ca7376a64590f6679971f84061c42aa03f0b07c7ebcb806ec8380d9ff0e182293f',
      '30acc02aecea9b91f3c6bb0f4ca8eea1b84a0ba6bbb8f7749fd29c9be5c5e28afae5a33617dfe3fc28ce3a78d1a19cdd',
      '5b2dabaf662b86dc4b1df6a2ebdeb5cff1f63c65ace5e1237db507dd3fa2c27ff46517b0fcd6f32f25dcd55acdc07fa0',
      '33be80b29355ab16aa0f05a45a8dc15a5ef7f9fee60bcbe05e106bf6fa0f196bfd9cbb8d79298360f760da7b05135f83',
      '048c648a525fab61cf81e087047044130e407b71ddd27293119689c8516b19ddc4f276e3b4e93e6ab80a79bb2700de68',
      'bf18ea9e00e6c2262d802fb66e04ffa21dc5c13640bbf27b2c22592de4afe31c18147e6ebd2d45669c36f9432494a000',
      '0a1a114981a785c399e2b21871a532b2a747fc67b4daa287c14f2f449fc6f7c6925db5e884e6e041d08bf6bc69295124',
      'ac6705c373300fcc09a291cff1834401fc30fad512569848a05171aa02426b7034ea2e4777aac2ddff48089226a4884c',
      'b7b08352ff8988c0ffe3fe0e27278f068bdc88aecba8d7acd8919850d7400a2c0a0a8519b264f61102290c9aaad3c2dd',
      '8f78c56a93b3dc69ecc5827f8d591195fb683a9951175754926a8e19f81ff859dc1904de12bc8482a760e998552d28e6',
      'e606004ecdc6878b5ec15f4554017ccf962e92cc6eaebe4997ba34ec0e53c67d564c8461c013701a401fe347ec0f721e',
      'ab7d7116f436ecb13ed2ec42347ddf902e0fd766ea8978cf93625f56b2164e2e630d6383eb03602a8df27f28f580e3c7',
      'd716be6974e46f19a606486be576ac6e250aae6ac2ace7ca9a924c874790e6b4c94670fd884a6ef770ec5e5f3f264306',
      '746eee51375e6695bc4b66190172dc6e86c18e144267c7b0133d6c2ece05f75b862e4c4ea5f813dd927d60c46e2c554f',
      '3d20e33ba4d52a8c374878f1a624a907132264d0c831c64fc51ed8e1cdb75d11c3fc78d4c3cfbf99d7f0bea9829b725c',
      'fe6a6ebbe30eea13ce04b1c8fa4199331b77566d2af420d4eacedcf22c23b3d7ad2313175389a0765ad60a79c0aa85c4',
      '1806469c58c028d7fbe80f219dd45333d440a824032778defc0a89cf704d40745f0f449f7df82d228e1718391c85f318',
      '20cd15e37f6371020b78579210ffd7756b42bd01eb829c1320c59ac382781ac4224439f1f820e215ee907091ee4f028b',
      '7967636e73e440ef1f8751441ade0f4d169167ac270949a758fe0ffe0b90c2773435623160e4bea5f23dbe0678e95ed2',
      '754f6d73a11693e07a2e5f05fbe13514c52f04f904131e0544202354d30917c333dc649ff7c33557005bb19b64db777d',
      '358d83f883166a6d2972c63f2a46ef893d2ff0f577a53830b3b8e2cb28d1efe8405084c145ee4e0bee5dfa9aef739263',
      'd74b6fd707bcec9419f032a9c21a7c79cd38f42d564057cdb956485fc5c2acaece9d86be8e12b9181018ea7871343147',
      'a517359a64226f2d08b65203593f3427dd42852476a7609c7f6423c304fba6ea83981470b8cf171f71bf02f688bb2448',
      '62162975f98c8ed1b74ade5b2325ec3d185f7bf8d9de6c08bb3ab052e54c28399aabe2be4295cbe12003a03924d4ee3f',
      '8f1e4237fbb668d2705fa6964ff50014f54ab6346a7decc8dbaa282b51803de20f9090e7af2e6b40fd8a138afe25e1bc',
      'f5f9fe110d809d34029de262a01b208356caec6e054c7f926b2591f6c9780579d4b59f5578c6f531a84f158a33660cef',
      '33ba080ec0ccb378e4e95fed3b26c23aa1a280476e007519ee47f60cd9c5c8a65d627259a9aa2fd33ca06d3c14ee5548',
      'f14fc73c4192759b70993dc35fbee193a60a98dbd1f8b2421afa253dec63015a0d6b75fb50f9f9a5f7fb8e7241540699',
      '72b9e34e0e655dcd7d9c288d11839a4fd96292f76f69bfb2e7d4f848e498b842cd4ed6486e77e30c603d218144aeefb7',
      'd71cbd531b25ba65e319954e5aa670c8055406a595d006f0dcee11afaaf735cb1615ebab4cc98061645fb70f31cdd9aa',
      '1f4398793ae7b2c4975ab102bc054dceecb238de4307b5dc54f6d7c20e066f638a782e33441533276df9db1ad0eaa75a',
      'ccd908195016dc596a78c6c10c92ef6f272c6251f3c40b2e7dad3a4538bf3ff585d4e44035b49ec397d1476e9dd28d02',
      'a8a26ddb23032bbd4432ac857383a5de280202b21ce173d864e19c4a52984e159bdd006d95605a4682458137fe6b71bf',
      '0c8d3031d85cefa23a09e13ce03623f0e648a030e43700c82aa1c8aa7e3ea9cecef3029a23815ad940cc39adb7747d2f',
      '0577ad6090b2a39ffa1c4a25436f9e958890c55a5b23cf8cee8195a5984316d81d6cf0b5916c0ad8b1f512fb39826c6d',
      'a5e7c31dcdec53d8898dcb27d52a5c1774115d8db163543a330ab502fe31d6017fa4ba4c65ade0cd911972c5a1b7739d',
      '2785c149b798e41e6ed600dda5257e2f31484ba4d14d35c8353ba4bb3bfb47f6e2cd9b64c940e3c1f83aa4587dc29caa',
      '977756eef1a7c1d4ca31a8e6936e7b8884968a22f2846f20b38f247345b1ccd47405040f727bbe2e0ffcd159206f5e87',
      '9e4811f182e5d6734ea097fcbc77892ec48f09dba138ad5a5abfe67f2e88ab61b0a3ecb29028b5528180191754231765',
      'e964c5cc45e8356dce9fffe715d01aeb3935d644dc9c2603acd175a04e8924dd84a4d88a1384d6baa8ab3f7f7d52d122',
      '764eb963850537e57d0969c9914355c5aa67aa9722644569b7f50e20da8461cc9c6ca5958abe10f5469e4dc1ed27619f',
      'd5fcfe2fcf6b3ef375ede37c8123d9b78065fecc1d55197e2f7721e6e9a93d0ba4d7fd15f9b96dea2744df24141ba2ef',
      'ca2385773319124534111a36d0581fc3f00815e907034b90cff9c3a861e126a741d5dfcff65a417b6d7296863ac0ec17',
      'ef49ae5b9ad51433d00323528d81ea8d2e4d2b507dbd9f1cb84f952b66249a788b1c89fcdb77a0db9f1feb901d47fc73',
      'd9b681ba08ec0d0598dd3a2a37f909d01a231d22da52216126534402a58a072db35fdae555b99159894bc823f9dacfe7',
      '961e792c94027a091df880a713ecbca94e7699fa392cca3e4b9988cb95dd46c894ab6cfa3de91236188f7a372b1c60c0',
      '779c845ced9623b6558577c06c6f22768e4a01ced2a9722cb8788fcca89e0b5cc6a8925533fd097f635997a9c191d59f',
      'f8a6fa1c730483ae488191e5863ab3dab4bbda1722710e519a2b2455273e78a382c60db0d21e3b497ef9eeb2780ab384',
      '1daa34486981474a57029f0b1ff5150a144cec7939a5d0c3d7dddc4f471225d98e83e8a0de880036f1a265e24ca1e674',
      '769694d69d701764bcf81c053e2899b232344506c08a39dede3d838f85870818c3a8cd2dbc8695edaf8fe34b4a5cc35d',
      '97e29e4ae7c7e461196c1d698b5d1186822bb66aca3b3e062a3ae07db9dd0fed83a345014d3e5ad89e9046606ad2cee7',
      '6b57593ee18186573f92273a9b722f9fd77a4a512164fe3756bc2d9f665768016eb2766c46d473a103d7d7090073271f',
      '35235261c522612958048b7fb8e48f96462d2b8b52ab2455c7c142e442e4cf643b367ed466a30ba97d91c1c8c0070e05',
      '67004a5e74598981a79984b2662fff8c8f49f8fd13c8a841f68dba18df68015e9c1ef38d6522d44f89dbfea8af48d2d0',
      '8acd05f9738bbb176e50c7419a05c8200e1ba84b5797032e025ed4b55d7a61cec4ce3662432a4e0ba938d8c9143d5254',
      '9963300c0ce5f2d39c2b899e47988bfa914d2ea2dbb972c15b3cbc414e41df3a2fe793597243d46cff937f41c0d83136',
      'fbee0f5e072237d19170999d02bb95f6f8f48fd0596a982a4fa2d1273872226398df57a63e1acccf6343415df387d89e',
      '32a65099c47eae3bcd0f68645845c0171417385b15db5e5f7bb5ad965f66c98cdc39b7534198af70ad5739c8a2f2b8da',
      'e936dba2ced7f65de3450ba7adbe1030d7aefafcce0cba94e671422790b45b49918319a90faa7692780cab4301d9833a',
      '1e20d13b4d71acbdbd5d2aa129e98929510c795119ea8a07ec63917114315e2756b45e7ae42e1a44c5e410ecbefb3661',
      '02a0571c5c3076cace7f061bdb108d7cd9c7ea51d0fbf1d00f202a0b5c87f22ce687d1cb15f798ed164caf1cecf92cf2',
      'ea07c4a1df1e5cb26dc7a7bc76fe518890fb8c424af3b1c76b37ab21445d9f7fbab73c7db35e85337a8f7a0d55121f34',
      '7829712876378df986a63e4616dca38dbe8833b14760168897aa808b96d8ffa4460ca3c1a9b674a0fc13e0625537c45a',
      'a7cbb3cd50aa663bd2c4520cceef123f7d314870806291da26a59c003d041e46e6b563670f27becc5f838a273d349afc',
      'c14e7f70d28e17d3546eb40ee96d239ca5ef7ebbbd0de64b964c145a5f2980d408a6ac248d651e4583e25093042ea286',
      '19f87bffbff4b1e195612f41e67e1d4cd0393e73fedac1c36550c2b1a7323d3e7d747eaab9844f45f150f8df0fb72e80',
      '6bfa3bc29fff3a92fec377af8508d4823f4e87072d6f2f16370b7dd30789a944ee5721efda7abfd47a512ea2d4984bc0',
      'ee10fdde70eb0a11462dc00860ac4756b21c83bff0066c431b17ba57ccbb9ed018e8058cb9ea44cc11952c3c9bd15f09',
      'e6a72b9d2a0ffca41c3122c767a6fd9cfa04cb5b1d1d94b79a0b2c592a584f731ca0523aea8f2dba35fdef74caf165ec',
      '59118a53c4479070dc728d94ba36d211f4ed5d35f1b69e4dfc0543f07326f982d2b81ddb020f2caccaf1e5e9832624e3',
      '63778b7830a3ab7421912a52b3ce9303a53c2a6655291042f428691a633fb9ff173937a8d8f59b21f72d490f39a9ac06',
      'a702f15d9483bb767fc6be9c3bfc64732277ce936aebade4022b24b4822bd1b0fa1213aacf7b4506bf8f330fb7643955',
      'a3fbea92041484f7f46b380462c5114b0243a79feed89ecf8e6d8306d60dbebdc5ff1578ee7e94b5527efc5707d2b7d3',
      '1eaea2602e0b6b328d008a5325c5d4f9dff7ab9bb5d36816d3ebfee733be664e35170506667bf5a24d00222ebc5dcdcd',
      '92e4d41594e15628bef06ca61e644d2a686c113bf8e3f9a8cd2cd8261b11d01b081ef2941d5182e565b70c566d461b23',
      '2f08daaa98de6db4e85b81e32c651d88075de18b7f9c3f633be1f29c89f24968525b1b357de80c6ea8d9570e003c75de',
      '5df64e7960c755d40be78f0bb7c1a185df8e505f0b421be23563472843e3b5cfc7da0f40908bf56c6f3a6244581c1de6',
      'dabb5dcbc32fe7298c811ce22025e9b1c0b87da5e7931cc3614e3ee39112206dd8422a5504f11599436b806c9108b01b',
      '31ae27382e330115e009474fb5ac750a278b79eff63755e323e3478b0761e5e946da6d2436dc44ade9f4578a8fba9896',
      '6804cf0314e455f499e73bbdf4faa22ca49020330e74c55b1cf4a2d2f4c57d7149b41916002b2852ecfa0713ba91a094',
      '7fad2ab0972d8059d4306f0b63f25d9acbbd8fd95ec8199cfa89d4e227eede6052af0c53c703c7e319047dc5734c9f4c',
      '4635e654950b173d3ec81a8212c1e65605c85835cfad8607c829786855636a660d6c3045ff17663de465bf2b152879e2',
      'b40764d8f066c897c3a8fe54bf21da294c6b3f1b35255f68c8ab325ab3b94ee8ae2e5173936c17fdc95c9b7c3d3d3a58',
      'ee7e424c550f79ba82043245c3b7d0ac32a41b876988c322b9997d87f0a0a1fb8263726b953b43b4616285a239994936',
      '627dceeacb27f39552ab683330a67a316b2f53842bce8056fcf3988702955e3ba72fdeeac2cdb53f13627858c1bbc51f',
      'dd13f3b3e9c79958b20d1986650a79cee1343f9957fbeede18b2fb5e543e3b8839edf7a57efd818129c4f00f505d2112',
      '0a7061c0fbf1ee8ccb0f4a1d0dcaf2f200291ac06830f0e38d05e1ca2429a2bf57de5bf8ded5a7cecc3a4748fbcb880e',
      '3635aea9152337fbfa4c2824c5499b9f3fd32061297c4121fb0a44cdf5d3c8d4c6efd760a0bf076dbd1801c416949a9c',
      'f9c58af2259c719b0b852fc68299ac9f17a802b49b34cbf5fbeb85db3c68767cc34dae2ccb536ff90bae49fddec0cfe4',
      '3541eb8602a4c84545f4476749ead54e4542c4358cc78ca5b7c8b6bcd9e9a3e649ccb243fe0b3d02930cf1cb7a507ffd',
      '4aa26c2565531a52811d30a1c59152bde4c61ae2ceafef9642e7076ec44c7ebd50f1d1853761b4097d985dfe6878a701',
      '32f1dd0b4af205b4891e2f43d772eb5e4a5ea3658106fdc8b8ceebd2d502f8048b583610a419e1a60020c8c2a5a02fc8',
      'da7403fe3c3d3139893522c5dc8e4f615d36a0f7b7b8aaf150d1337c8dfe70311544e54880d1c575d664e9af979984d9',
      '39f8450d4a946abc6fca804ae11935cde846d999bcff3091f1e6944eaead504f77139a919f915d34dacc13757cce0157',
      '45cc03085cc3278b8337096bedfe6f1d645994690660f23a358c4ec728ebafd6966c487b9492de217c17823b16589852',
      'a2150f3ba3349e3aa0ed97b1a02a58f31eb5731012393ec68846d95465f3b787c272852b6945b1cc0fc2b3be999e0e46',
      'bf9392b085b3c5ffbde70a3fb64aab36e39bde4816f1c9b2a608269336906303f7dfc15f4701d3fafa5d7a8bfe316a1b',
      '21bda179d5b80fa6b9444ab1d1f7e06f89f670da4a038e7e83e8a63cedd44ab6c1d069d12c6f538b45022ef3160d396d',
      'b4216cde6bc1c27a5c1ea9ac79e85776740f93440ae438d4d9cf51be8a83ad44565586fbfb58dd743782724a440218e8',
      '5c3d5c00381bccf77fc2103c262f373592fe34c2b2895f54bcfd1f9b3c87026288130822b2b451d716fa9d4d7fcc93f5',
      'b927e3777d4be05fa85d0cb707fb00f08c576777840634531795cd3d6818f192789977ad6425018025e10f5892ffe708',
      '9c6976e1edfaedc32378c8d2758d1b0c5b287c500442ec5d19560bc87c75fd2a7379a3e64adc1421b7410d1add6456bb',
      '9c20482ab71bbd8e985d7891499db526bcaae11d2a42dd72ffed664d7bf7f254c2f8dda2e340690fb83e1f5c58378b72',
      '7899d5af410188a3d0d0b12d52437313d786ce7959fc4d194d6a3aca85729b60abbdc58ac40731b9e833505156befe24',
      '4f958fd1841d2b790a199ee3358f4dceec64cb34d0886ea91aa5e38f8600fbe13dee4d6a55ac1273b3730cc62a3611b7',
      '66572f61fe6c34b440ac00c8d3992b9cde3fc465fcbb193cb7716b53e8032c743718d4f8245d94a22a9ae125795589e0',
      'e7ad49861960d1460a77f4f363341adc2207e205302957250612c7e903802af5c9423414c52f4c1ad55cc1c8b2922ef8',
      '62be3aa3a9d08cb41f2ca3abccb96e2e91a248e569ff58f58c8becdda5b4b25ff46bb30eb37999e6131d944cf3253302',
      '3e082f7dbdf5bba5f52cc870f2c6e9c63dfcd5d547b183f3ffbe392bf0a1f8f4970ca21e5b9b4306792c138d6b2056c3',
      '5cc36277225da2edcc6cb603ede9c629e5da823e6d233ab7833f70fea2878b2f8d08f361bd5b4c7609577329784d87dd',
      '9555eeee1ee60ee981ced3fb6bf74699e5383436acc283bda0f9f6ffe20561ece75ece2c5a82c0a158c071a3ba59cf58',
      '0b975d2abd0551ba987680c4890f80df93af2292fdd1e47322560b0ad3bdd38a67d3a78497d78b3c38da597846c5159d',
      '016ce0b8ad1628c7fba358eebb7c3667fa93566086b99f20ea6f87fbacb320e7bceebabf0008550a59ac1e6c3b4478dd',
      '3d138114480946a2aa1e2b78948b6bfea95f53bd8bed81ecce166062a67fd111933a696e6fffbfcbddf71041955c98a0',
      '7ea4bb2534c67036f49de7beb5fe8a2478df04ff3fef40a9cd4923999a590e9912df1297217ce1a021aa2fb1013498b8',
      '80c399c975addab12fa20b3c3d04f25218dfeb678b5a87f9963a462f5474732c7c5fafe0ebbbaa94662789cc10c9aacb',
      'c27e28a5b6c7bfbc7ed372b5bd2555ef1370fd96043753015b3fb9af31d41e7189d4fa8860b183703560a298d90b6e75',
      'b792b021b3fa904b5948afb4e56bd4c40119ac79e57eb24c32a7bf0a1a889313d816997e35f2ca192b34d2ff9b05ed9a',
      '7828c6235e2b8ac46e4bcd7f7c7554ea81b5bfc046133eefa0c4e64aaaad7115b04ee09e33cb4ea1ff476960c64d9a36',
      '06678f9a2f238953a8d6646f859fcc3bb0c29baba669d7f891142c2c3a0bac1220200b4eff8c17f5d79e261128c58248',
      '0fd4448a47b6620fe90551a9aa06dd991ab13dbd2af18a4f17ae4a9a24d9a83e7653d5f5a2c54633c42accb0e5915a35',
      'aabbb8857de60bdbb21742de7acf7eb8d9180d5d0aed23b7f708f09006c6fc56ce85db87d9642cb909038e70c15c1574',
      'e1bf933a4f32af56c929911284f9b05b79f0216ef3a150483d74b2d4dcd78885190eb1601a320150c860168221c6ba49',
      '9074b187372b0535738d4606aa0478becb5251eaec961699c2795fc028d641d60230532c8f6a096fef419a46b0db87fc',
      'a63532a684a1851050e2861f7ab94296d131f768a94ab0019a941734e13842ebe8ab1f42db4d0a84e261cb4707c74290',
      'ddfd64103308f0537abd8d4f2209d8920cb42fa9ecbc93318d438c1493fe11b6134ddff95dbe3fc6b8aa31f833e305a6',
      '044ed56ef3129d29243665545a59fdc12412e137e1f55a543aace511f9f86cd3202e3d24807b0fc878ba76223edc6f42',
      '2e470ab58a76690755ae6643d615039e767b84ae9e68480dd937913c44ac2350a27fdb45d6fadc242bd5f84809d59e2a',
      'ec0abac477b5ad5f6b11db4b699283fd4668d84c2ba7f8df90a5bf83c0e1e224623f0d2bb3f2dc6eaac5e41436035d58',
      '9febb6c1604914837f6d00f9ae23a3459dedcfd81ef755b96a3cc1f63e4cd2e67f5ac2605e594dcd2610f4962ea6c277',
      '3873bf1a102f1609a624f1a096e420cc459c02590600808f7da5e3fd49f5b491269c1116a2ac74185a3105b5e9606126',
      'cd7e8c16b59bcee5888dc7ffc28e65b72570b26f3a0c85885bbce81e5a6b63d781f953e497399dcb506e8c4f5e237169',
      '3d24bc91a4932bf6d631eb7698549b03e7f3930662b8527ec122fc2c7aa41e330862102557f480273864ff9b06628bb2',
      'f0b21bc919a3c6089be3cb7ce10b55d76e31552e759f0465086a89d1fa435e2671928ac329ed7b3d7c1d7121c158babe',
      'b32f9a1fd8a97e6e8e701371bf1a017078b26c3f4c58e342ed455b2557bda16eafac00aeac1ed7328c65d7c1e227fb83',
      '5468f1b9192244c738ec20fa979f746cf6929fc48f69c79f43e46859aa022cc42e65203ce7cf77a039402093a1552ec0',
      'a58151fe3211c27651693b55e67cde0e886bb0d8f2b6d9066615124cf1da403dfa014c6f19c1b10de7d3bbdbd0ab9880',
      'fe73fd3276463d27ae6a9f54877cd9bd3410c4a40381d25f5a915194538ca8c4f4b6154ecb9ce8b1b7e23953dc64f664',
      '0d4ea680ba7ccbb9d88c09f6daa6bc655bdb0b2a1c8c3de0be895328027794e223a45969ae594c7a21fabd5c92ba6530',
      'e6dc0e64dc804fef91563b550a83be7abd50f51d3bffa785a428ef9436775dd7e3a589793cb2717dc6bad8b531cfc922',
      'de168b8f03c0ce8143fd14bd2d294476fbe8da85b09bf26c5d846e2d19957f87d6fe150b278ea4b3bcd36ae52d251fe5',
      'f34472a4df2d3b529ce56e9d2a721a839db05db7b66be8ab7202b024defd46acf493973dd1fe88d8ef6e70673914daa9',
      '1f5e8ffb4678b3889e7feb2288358a5f1377a97f76674a8d3e5ef39d185d02f6a1fb60e43bcc79c31e6974b37e74e50f',
      '190aff1d363c413bee16c78c544afd20678c7b1141d3917b6942e4d1486edbcee90ede8a50e441219ed3b11befa09f18',
      '66bb67fc2bdc1d5e8e4366958804f459aa689e04d5fcafa8ca222656d568b23e976086e2bbad979ea0973aaa1fadeb8a',
      '0e14c70c02205aa29303d24d6491cc84b648eeb80ae9cc2a0997b7bb646ed32c69d2ae41c0dc007afcec514d7b04bcd6',
      'e38c413f3fc12764415f39a9f3638aa1204d3e818a43cf2edd9f2ce01936d36c6720cf5be8aba362f92aec81386a4800',
      'c3ed0b3697a84b388aa83dff8eaa65f5bb12ef00315ad462f1f6d85d410d021bc32e77adc763a254f7d9f1fb6eeef1f3',
      '8dc2c3f8c13c43709aaebd408a679cec524da8c8f4157da4be551efd687a395b33577728eb73eb498ecd0ad2487058e8',
      '8ae817f2056903661e4ebf37d7293200d8bee7ae0cadea671e4987624a43712fd2c392e37c17d8e81eaeebee8e96653f',
      '9a622bc18f3a09c8bc1c8603b55260badf32ae7abd8dcb6cdd980c5e7a5b8a38c6d287a63fe88567bb9b0481743c06d9',
      'b74c6303ddf9f0ad7cbee923f7f7f1c7fa52c84ef609f2bbcc07b9911c12f3d1a9bd818a9f36ebb40d4b400aa4d0fdc1',
      '5b1ad3420ed592fa3d593435ca6ebc700583ac5e3ca2876887e5f190ec2109a1e6dd06afc6c9d7ed0e8b0272b7f9114e',
      '2556cf077a788c49bb6d600f4a3cee635c4443832d169f761537afee2980742b9f34afbc87f598dd0aedc4a826ed6a73',
      'd64769ad58f5a338669b935f3431e5bef31667d0a2437bff78f1e5275075f434fff675f9833ea04ac4e5c2e2c2c99b8c',
      '3264cad70d24b53cec95269b980dab85a30d24cf8bdbd68f0ff8a45c6208f05723a4b3270cd095fb8b2d9a4167fb3d3b',
      '4d564117e87700c69afe5a4d90ff50def8a54a9bf19382e4290290d2bee101355ebb2dfb2a9d6d044a6d12d6ddf7bdbe',
      '6aad71fa5d5d7b63fea64d94e211155b01f8c9e4b3d86c3b9c014ca4bb6c668037c4739a082f37b2ec5ff6d85f0a58ff',
      'b36d529e55b5cf0fd3273f204f798e21df533be466ad1af35ef80082132640493fd89a6cf41ca68aed066e93181a9eea',
      '78814e883a27d6ed3a5b122260059cc00d31b8a0e933f3c377bb99ef33f47b13b6ad825b740784bebdd9917879c2daef',
      'a7978d0c79070b208f070241867476ae622ea887d26b0f6703fa8a455f411649d8919e6e12c540c59df60ca9c05684cc',
      'bdc3e02d31db1eb7f04cd9fb8876aa9c7cb1852bd3bd62f56e062e216be648a34fd327b84e3b6339f44697470711f661',
      '9135e6d4b1e2356c3de16a85e4af57243cf6861dfb6c53ca13d9481371aee285b75dccafc1a64499f1b2cbe4a3cd82c8',
      'd1f9baa4007bad437509db6f6dca22086cb786026553244a6f480c3a6488f7e26c416c6ae85874477bb5563ba0aecf2e',
      '49e5b7521794b6c73004badf3d039f4185be9bf8499fb08b9c8fda2186b6c4bcd280ae2d2051c6775c19ecf1c776acf6',
      'a7534c1716b59ab1c7af3df0ae32f22cd02a1823f61b318f36dfb536b8ef4515116a099f8ded19b00ee7b2d243539960',
      '0f01fb323fadd9380a5e4ee6371e8bdf6ffb1f70c4d4a1b5e8bc9b281582ae0531ab354ea9f58a96568826f6172fc75c',
      '145c9d3926904d8418b75c8d645d43af651684ae7fad885ab46141b9ead2d9727731f44d5aaa0204395e020d1b52da96',
      'f663682ef7fa3f300dff0b4d9c0d2d126f2bbc164f3b88c8a2207c3799464ed2086cdd324c1e88daa6ef2d53cf7c190b',
      '98d7ac796c4cfb5d98a1c323656a4be8afaaad168e5ee72b6b7a3fa3260461a043e27243120d41584b58f1ae4463121a'
      ];

  for (var i = 0; i < expected_values.length; i++) {
    var hash = new SHA384();
    hash.add(createTestArr(i));
    var d = hash.close();
    Expect.equals(expected_values[i], CryptoUtils.bytesToHex(d), '$i');
  }
}

void testInvalidUse() {
  var sha = new SHA384();
  sha.close();
  Expect.throws(() => sha.add([0]), (e) => e is HashException);
}

void testRepeatedDigest() {
  var sha = new SHA384();
  var digest = sha.close();
  Expect.listEquals(digest, sha.close());
}

void testStandardVectors(inputs, mds) {
  for (var i = 0; i < inputs.length; i++) {
    var hash = new SHA384();
    hash.add(inputs[i]);
    var d = hash.close();
    Expect.equals(mds[i], CryptoUtils.bytesToHex(d), '$i');
  }
}

void main() {
  test();
  testInvalidUse();
  testRepeatedDigest();
  testStandardVectors(sha384_long_inputs, sha384_long_mds);
  testStandardVectors(sha384_short_inputs, sha384_short_mds);
}

